---
layout: post
title:  "üê≥ Docker study 4th [ENG]"
series: "docker"  # Docker ÏãúÎ¶¨Ï¶àÏóê ÎåÄÌïú ÏãúÎ¶¨Ï¶à ÏßÄÏ†ï
subtitle: "Running RStudio on Docker: Leveraging GPU for Data Analysis"
date:   2024-10-17
author: Arielle
categories: [code-road]
tags:   Docker Autonomous_Driving NVIDIA Azure Cloud
#cover:  "/assets/instacode.png"
---



---

<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Docker Study</title>
    <style>
        h2, h4 {
            color: SteelBlue;
        }
    </style>
</head>
<body>
</body>
</html>

<p>
<em>
In the previous <Docker Study 3rd> post, I set up a Python environment in a container, or virtual environment, using a Kaggle Image. For this 4th week, I conducted a hands-on session to build R, a widely used data analysis environment, using a Kaggle Image.

This time, I delved deeper into Dockerfile, but even though it was covered in week 3, applying it in a new context made my mind go completely blank again. (Maybe I was a goldfish in my past life...ü§¶‚Äç‚ôÄÔ∏è) 
</em>
</p>

<p>
<em>
Since I'm constantly encountering new concepts, I feel like I'm learning at a slower pace, but at least I have the determination to solve the challenges ahead, which is a relief! üí™

If you can‚Äôt summarize what a ‚ÄòDockerfile‚Äô is in a single sentence before diving into this post, I highly recommend quickly reviewing the üìÇ Dockerfile? section from the previous post! üèÅ
</em>
</p>
---
<h2>1. Setting up a R analysis environment</h2>
<h4>1.1 Installing a Kaggle GPU image for R</h4>

If you search for ['Kaggle gpu R image'](https://github.com/Kaggle/docker-rstats), you'll find a link to download an image that allows you to use R inside a container. Since the process is similar to building an image for the Kaggle Python environment, it was relatively straightforward. As of the installation date (October 14, 2024), the latest version of R is v59.

I installed it <code>docker pull gcr.io/kaggle-gpu-images/rstats:v59</code> on the virtual machine. 

<img src="{{ '/assets/p.14/p14.1.png' | relative_url }}" alt="Descriptive Alt Text" />

<h4>1.2 Running an R container in the RStudio Server IDE environment</h4>

So far, I have been using Docker by downloading the necessary images and running them in the container, essentially in a virtual environment terminal. This time, I attempted to run the container in an IDE environment (Web) using RStudio Server.

The image below shows the result of accessing the IDE through the R container, successfully running within a web interface.

<img src="{{ '/assets/p.14/p14.2.png' | relative_url }}" alt="Descriptive Alt Text" />

This can be achieved with just a single command. It's a bit long, but if you break it down step by step, it's not too difficult to understand.

‚úÖ <strong>Rstudio Web Browser connect code</strong> ¬†<code>docker run -d -p 8787:8787 --gpus all -v "/home/Arielle/rproject:/home/rstudio/rproject" --name rstudio-container gcr.io/kaggle-gpu-images/rstats:v59 /bin/bash -c "rstudio-server start && tail -f /dev/null"</code>


The command <code>docker run -d</code> is used to start a new container based on the specified image. The -d option enables "Detached mode", which allows the container to run in the background. This means that the terminal remains free for other tasks and is not locked to the container process.

If the -d option is not used, the terminal will remain attached to the container‚Äôs process, preventing you from executing any other commands while the container is running. Therefore, using -d is important when you need to run a container in the background and continue working on other tasks in the terminal!


The option <code>-p 8787:8787</code> is used to set up port forwarding between the host system and the container.

The first 8787 (before :) refers to the host system's port.
The second 8787 (after :) refers to the container's port, where the RStudio Server runs by default.
This configuration allows the RStudio Server inside the container to be accessible from your local system. As a result, you can open a web browser and access the RStudio Server by navigating to:

üëâ http://localhost:8787

This way, the host system forwards requests from its port 8787 to the same port inside the container, enabling smooth interaction between the containerized R environment and your local browser. 


However, while explaining this in a simple sentence, I realized that I didn't have a clear understanding of ports. As I followed the lecture, I kept questioning whether I truly grasped the concept. (The only port numbers I was somewhat familiar with were 1004 and 22?? ü§®)

So, to never get confused about ports again, I decided to take a step back and properly organize my understanding of them! Let‚Äôs dive into it!

---
<h4>üö™¬†Port?</h4>


First of all, I didn't fully understand what ports were, but I had unknowingly been using them in various places. One representative example was when I set up a Mac virtual environment [using RDP](https://arielle0222.github.io/code%20&%20road/2024/10/05/docker.html) (check out the post here).

To make it clearer, I created a simple diagram that visually organizes my understanding of ports. See below!üëá

<img src="{{ '/assets/p.14/p14.1.1.png' | relative_url }}" alt="Descriptive Alt Text" />


From the client-server perspective, as shown on the left side of the diagram, each service that the server provides is assigned a specific port number, which allows clients to connect to it.

For example:

- RDP (Remote Desktop Protocol) uses port 3389.
- SSH (Secure Shell) uses port 22.
- VNC (Virtual Network Computing) uses port 5900.

What about the Docker container perspective?
Now, let's shift our understanding to Docker containers. In this perspective:

The traditional client (a user or device) is replaced by the local host.
The traditional server is replaced by the container.
A Docker container can be thought of as an isolated, self-contained environment designed to run a specific application or service‚Äîsimilar to an independent computer.

One important takeaway from the diagram is that containers operate within a "User Space" on top of the host operating system. Inside this space, each containerized service (application image) runs separately, maintaining its own environment.

Even though containers share the same host machine, each container runs its application in isolation, with dedicated resources and ports to communicate with the outside world. This is why port forwarding (e.g., -p 8787:8787) is crucial in Docker, as it allows external access to the services running inside containers.

You might wonder why I suddenly started talking about container structures while discussing ports. Earlier, I mentioned that each service is assigned a unique port number. This means that the RStudio service I just downloaded must also have a unique port number. That number is 8787, as seen in the command <code>-p 8787:8787</code>!

However, you‚Äôll notice that 8787 appears twice, separated by a colon (:). The first 8787 represents the port assigned to the localhost, while the second 8787 is the port assigned to the container. This is different from traditional client-server models, where only the server side is assigned a port number. Here, both sides are assigned a port number‚Äîthis is the key difference!

Another interesting point is that the port number assigned to the localhost does not have to be 8787; it can be set to any number the user chooses.

This raises another question: When would you manually specify the local host port number?
The answer is when you run multiple RStudio Server containers on the same machine. In such cases, assigning different local ports to each container ensures flexibility (pliability).

However, the reason for setting the same port number for both the localhost and the container is not just for convenience but also for isolation. When multiple containers are running, having the same port number makes it easier to locate each service. This concept naturally leads to the discussion of isolation.

By default, a container operates in complete isolation from the external environment. However, when we specify a port pair, we establish communication between the localhost and the container. This allows the isolated container to become accessible from the outside, which is where Docker‚Äôs true power comes into play!

---

Now, let's return to the command for running a container on the web! After specifying the port, you‚Äôll notice the option `--gpus all`. As the name suggests, this allows the container to access the local GPU resources. If your local host is equipped with a GPU, the container can utilize it for computation. However, if GPU access is not needed or your system doesn‚Äôt have a GPU, you can omit this option without any issue.


The part -v "/home/Arielle/rproject:/home/rstudio/rproject" represents the concept of Volume Mounting in Docker. In simple terms, volume mounting is a feature that links a file or directory from the host system to a specific location inside the container.

Here, we are pairing:

- Host directory: `/home/Arielle/rproject`
- Container directory: `/home/rstudio/rproject`

This setup allows for seamless file sharing between the host and the container. You can:

- Use files created on your local machine inside the container
- Access files generated inside the container directly from the host

For example, if you run the command mkdir testfolder on your local machine, you can immediately see the newly created 'testfolder' inside the container‚Äîas shown in the image below (Container with WEB)

<img src="{{ '/assets/p.14/p14.8.png' | relative_url }}" alt="Descriptive Alt Text" />

The option `--name rstudio-container` is used to assign a name to the created container, and here, it is specified as `rstudio-container`.

The last part,`gcr.io/kaggle-gpu-images/rstats:v59, represents the Docker image (RStudio), indicating its repository path and version.

---

<h2>2. How to work Python package in R?</h2>

If you have successfully connected to your local host through the container, you will see the R program interface as shown below. Since I had never worked with R before, I wasn‚Äôt familiar with its syntax. The command `reticulate::py_config()` is a function in R that sets up and displays information about the Python environment.
Interestingly, R can integrate with Python using the `reticulate package`. When I ran the command, I noticed the following message appeared in the console:

<em>Would you like to create a default Python environment for the reticulate package? (Yes/no/cancel)</em>

This message indicated that there was no existing Python environment linked to R, and the reticulate package was prompting me to install a new one. So, I simply selected "YES" to install Python and proceed with the setup.

<img src="{{ '/assets/p.14/p14.5.png' | relative_url }}" alt="Descriptive Alt Text" />

For reference, while I was able to visually confirm RStudio using the RStudio IDE, this time, I checked it through the container‚Äôs terminal mode. (After all, it‚Äôs good to learn both GUI and terminal approaches!) First, I ran `docker ps` to check the name of the running container (rstudio-container). 

Then, I used the following command to directly access RStudio within the container. `docker exec -it rstudio-container R`
As shown in the image below, R ran successfully within the container‚Äôs terminal, confirming that it works properly even without a graphical interface.

‚úÖ¬† `docker exec -it rstudio-container R`  Ïó¨Í∏∞ÏÑú `-it` Îäî `-i` (interactive), `-t` (tty)Í∞Ä Ìï©Ï≥êÏßÑ Î™ÖÎ†πÏñ¥Î°ú Ïª®ÌÖåÏù¥ÎÑà ÎÇ¥Î∂ÄÏóêÏÑú Î™ÖÎ†πÏñ¥Î•º Ïã§ÌñâÌï† Ïàò ÏûàÍ≤å Ìï¥Ï£ºÎ©¥ÏÑú ÎèôÏãúÏóê ÌÑ∞ÎØ∏ÎÑêÏóêÏÑú ÏûÖÎ†•Ìïú Î™ÖÎ†πÏñ¥ÏôÄ Ï∂úÎ†•ÏùÑ Î≥¥Í∏∞ ÏúÑÌï¥ ÌôîÎ©¥ÏùÑ ÌÑ∞ÎØ∏ÎÑêÏ≤òÎüº ÎßåÎì§Ïñ¥Ï£ºÎäî Í∏∞Îä•ÏùÑ ÌïúÎã§! (Ï∞∏Í≥†Î°ú Ìï¥Îãπ ÌÑ∞ÎØ∏ÎÑêÏóêÏÑú exitÌïòÍ≥† Ïã∂ÏúºÎ©¥ `q()` Î°ú ÎÇòÏò§Î©¥ ÎêúÎã§!)

<img src="{{ '/assets/p.14/p14.6.png' | relative_url }}" alt="Descriptive Alt Text" />

ÏïÑÍπå RStudio(WEB)ÏóêÏÑú PythonÏùÑ ÏÑ§ÏπòÌï¥ Ï£ºÏóàÎã§. ÏÑ§Ïπò Ïó¨Î∂ÄÎ•º Î¨ºÏñ¥Î≥¥Í∏∏Îûò ÏñºÎûòÎ≤åÎûò ÏÑ§ÏπòÎ•º ÌïòÍ∏∞Îäî ÌñàÎäîÎç∞ Ïñ¥ÎîîÏóê ÏÑ§Ïπò ÎêòÏóàÎäîÏßÄ ÌïúÎ≤à ÏØ§ÏùÄ ÌôïÏù∏Ìï† ÌïÑÏöîÍ∞Ä ÏûàÏùÑ Í≤É Í∞ôÎã§. `reticulate::py_config()` Î°ú ÌÑ∞ÎØ∏ÎÑêÏóêÏÑú ÌôïÏù∏Ìï¥Î≥¥Îãà `/root/.local/share/r-minicconda/env/r-reticulate/bin/python` Í≤ΩÎ°úÏóê ÏúÑÏπòÌï¥ ÏûàÏùåÏùÑ ÌôïÏù∏ÌñàÎã§. Í∑∏Îü∞Îç∞ ÏßÄÍ∏à Î≥¥Î©¥ `r-miniconda` ÎùºÎäî Ìè¥ÎçîÏùò ÌïòÏúÑ Í≤ΩÎ°úÏóê pythonÏù¥ ÏÑ§ÏπòÎêòÏñ¥ ÏûàÎäî Í±∏Î°ú Î≥¥Ïù¥ÎäîÎç∞, ÎÇòÎäî Ìï¥Îãπ Ìè¥ÎçîÎ•º ÏÉùÏÑ±Ìïú Ï†ÅÏù¥ Î∂ÑÎ™Ö ÏóÜÎã§. 

Ïù¥Î•º Ï†úÎåÄÎ°ú Ïù¥Ìï¥ÌïòÍ∏∞ ÏúÑÌï¥ÏÑúÎäî Docker Ïª®ÌÖåÏù¥ÎÑà ÎÇ¥Î∂ÄÏóêÏÑú RStudioÏôÄ Python ÌôòÍ≤ΩÏùÑ Ïñ¥ÎñªÍ≤å Ïó∞Í≤∞ÌïòÍ≥† ÏÉÅÌò∏ÏûëÏö©ÌïòÎäîÏßÄ Ïù¥Ìï¥Ìï† ÌïÑÏöîÍ∞Ä ÏûàÎã§.

<img src="{{ '/assets/p.14/p14.7.png' | relative_url }}" alt="Descriptive Alt Text" />

<img src="{{ '/assets/p.14/p14.7.1.png' | relative_url }}" alt="Descriptive Alt Text" />

Î∞îÎ°ú ÏúÑ Í∑∏Î¶ºÏúºÎ°ú Ïù¥Ìï¥Ìï¥Î≥¥ÎèÑÎ°ù ÌïòÏûê! ÌååÏù¥Ïç¨ Ìå®ÌÇ§ÏßÄÎ•º Ïù¥Ïö©Ìï¥ Keras, TensorflowÍ∞Ä RÏóêÏÑú Ïñ¥ÎñªÍ≤å ÏûëÎèôÌïòÎäîÏßÄ ÌîåÎ°úÏö∞Î•º Í∑∏Î¶∞ Í∑∏Î¶ºÏúºÎ°ú Ï¥ù 5Îã®Í≥ÑÎ°ú ÏßÑÌñâ ÎêúÎã§. 

1Ô∏è‚É£ RÏóêÏÑú Îî•Îü¨ÎãùÏùÑ ÏàòÌñâÌïòÎ†§Î©¥ R Keras Ìå®ÌÇ§ÏßÄÎ•º ÏÇ¨Ïö©Ìï¥Ïïº ÌïúÎã§. ÌïòÏßÄÎßå, R ÏûêÏ≤¥ÏóêÎäî KerasÎÇò TensorFlowÍ∞Ä ÎÇ¥Ïû•ÎêòÏñ¥ ÏûàÏßÄ ÏïäÍ∏∞ ÎïåÎ¨∏Ïóê Python Ìå®ÌÇ§ÏßÄÎ•º Î∂àÎü¨ÏôÄ ÏÇ¨Ïö©Ìï¥Ïïº ÌïúÎã§.

2Ô∏è‚É£¬†Ïûê Ïù¥Ï†ú Python Ìå®ÌÇ§ÏßÄÍ∞Ä ÌïÑÏöîÌï®ÏùÑ ÏïåÏïòÏúºÎãà RÎ°ú Í∞ÄÏ†∏ÏôÄÏïº ÌïòÎäîÎç∞ ÌäπÏù¥ÌïòÍ≤å RÏóêÏÑúÎäî `reticulate` ÎùºÎäî Ìå®ÌÇ§ÏßÄÍ∞Ä ÌïÑÏöîÌïòÎã§. Í∑∏ÎûòÏÑú `/root/.local/share/r-minicconda/env/r-reticulate/bin/python` Ïù¥ Í≤ΩÎ°úÏ≤òÎüº `r-reticulate` Í∞Ä pythonÏùò ÏÉÅÏúÑ Í≤ΩÎ°úÏóê ÏûàÏóàÎçò Í≤ÉÏù¥Îã§!

3Ô∏è‚É£¬†ÌòÑÏû¨ Python Ìå®ÌÇ§ÏßÄÏùò Í≤ΩÏö∞ reticulateÍ∞Ä ÏÇ¨Ïö©ÌïòÎäî Python ÌôòÍ≤ΩÏúºÎ°ú Îì§Ïñ¥Ïò§Í≤å ÎêúÎã§. Ïù¥Í≤å Î¨¥Ïä® ÎßêÏù¥ÎùºÎ©¥ ÎßåÏïΩ `reticulate`Í∞Ä minicondaÎùºÎäî Í∞ÄÏÉÅ ÌôòÍ≤ΩÏùÑ ÏÇ¨Ïö©ÌïòÍ≥† ÏûàÎã§Î©¥, Python Ìå®ÌÇ§ÏßÄÎäî miniconda ÌôòÍ≤Ω ÏïàÏóê ÏÑ§ÏπòÎêòÏñ¥ `miniconda`Í∞Ä Python Ìå®ÌÇ§ÏßÄÎ•º Ï†ÄÏû•ÌïòÍ≥† Í¥ÄÎ¶¨ÌïòÎäî Í≥µÍ∞ÑÏù¥ ÎêòÎäî Í≤ÉÏù¥Îã§. Î∞òÎ©¥Ïóê ÎßåÏïΩ `reticulate`Í∞Ä Îã§Î•∏ Python ÌôòÍ≤ΩÏùÑ ÏÇ¨Ïö© Ï§ëÏù¥ÎùºÎ©¥,Í∑∏ ÌôòÍ≤ΩÏóê Python Ìå®ÌÇ§ÏßÄÍ∞Ä ÏÑ§ÏπòÎêúÎã§Îäî ÎúªÏù¥Îã§! ÏòàÎ•º Îì§Ïñ¥ ÏãúÏä§ÌÖúÏóê ÎØ∏Î¶¨ ÏÑ§ÏπòÎêú PythonÏù¥ ÏûàÎã§Î©¥ Í∑∏ ÌôòÍ≤ΩÏúºÎ°ú Python Ìå®ÌÇ§ÏßÄÍ∞Ä ÏÑ§ÏπòÎê† ÏàòÎèÑ ÏûàÎã§. 

ÏïÑÎ¨¥Ìäº Ìè¨Ïù∏Ìä∏Îäî `reticulate`Í∞Ä ÏÇ¨Ïö©ÌïòÎäî Python ÌôòÍ≤ΩÏóê Îî∞Îùº Python Ìå®ÌÇ§ÏßÄÍ∞Ä ÏÑ§ÏπòÎêòÎäî ÏúÑÏπòÍ∞Ä Îã¨ÎùºÏßÑÎã§Îäî Í≤ÉÏù¥Îã§!

4Ô∏è‚É£¬†ÏúÑÏùò Îã®Í≥ÑÍ∞Ä Ï†ïÏÉÅÏ†ÅÏúºÎ°ú ÏßÑÌñâÎêòÎ©¥ PythonÏùÑ ÏúÑÌï¥ keras, tensorflowÎ•º ÏÇ¨Ïö©Ìï† Ïàò ÏûàÍ≤å ÎêúÎã§. kerasÎäî RStudioÏóêÏÑú ÏïåÍ≥†Î¶¨Ï¶òÏùÑ ÏÉùÏÑ±Ìï† Ïàò ÏûàÍ≤å ÎêúÎã§.(UI)

5Ô∏è‚É£¬†Ïù¥ÌõÑ TensorflowÎäî KerasÏùò Î∞±ÏóîÎìúÎ°ú ÏûëÎèôÌïòÎ©∞  Ïã§ÏßàÏ†ÅÏù∏ Ïó∞ÏÇ∞ÏùÑ ÌïòÍ≤å ÎêúÎã§.

---

<h2>3. Custom Dockerfile</h2>

ÏïûÏÑú Docker study 3rdÏóêÏÑú DockerfileÏóê ÎåÄÌï¥ÏÑú ÏïåÏïÑÎ¥§ÏóàÎã§. Í∑∏ÎïåÎäî Î∂ïÏñ¥ÎπµÏùÑ ÏòàÎ°ú Îì§Î©¥ÏÑú DockerfileÏùÑ Î∂ïÏñ¥Îπµ ÌãÄÏùÑ ÎßåÎìúÎäî Î†àÏãúÌîº Ï†ïÎèÑÎ°ú ÏÑ§Î™Ö ÌñàÏóàÎäîÎç∞, Ïù¥Î≤àÏóêÎäî Ï°∞Í∏à Îçî ÏÜåÌîÑÌä∏Ïõ®Ïñ¥ Í¥ÄÏ†êÏóêÏÑú ÏÉùÍ∞ÅÌï¥Î≥¥Í≥†Ïûê ÌïúÎã§. 

---
üìÇ¬†<strong>Dockerfile?</strong> ([‚ÄôüëâüèªDocker study 3rd'](https://arielle0222.github.io/code%20&%20road/2024/10/11/docker.html))

#**Î∂ïÏñ¥Îπµ ÌãÄ**ÏùÑ ÎßåÎìúÎäî Î†àÏãúÌîº

DockerfileÏùÑ Ïª®ÌÖåÏù¥ÎÑàÏóêÏÑú Ïã§ÌñâÌï† ÌôòÍ≤ΩÏùÑ ÎßåÎìúÎäî Î†àÏãúÌîºÎ°ú ÏÉùÍ∞ÅÌï¥ Î¥§Îã§(Î∂ïÏñ¥Îπµüêüüçû Îã§Ïãú Îì±Ïû•). Ïö∞Î¶¨Í∞Ä Ïñ¥Îñ§ ÌîÑÎ°úÍ∑∏Îû®ÏùÑ Ïã§ÌñâÌïòÎ†§Î©¥ Í∑∏ ÌîÑÎ°úÍ∑∏Îû®Ïù¥ ÎèåÏïÑÍ∞ÄÍ≤å Ìï† ÌôòÍ≤ΩÏù¥ ÌïÑÏöîÌïòÎã§. ÏòàÎ•º Îì§Ïñ¥ ÌîÑÎ°úÍ∑∏Îû®Ïù¥ PythonÏúºÎ°ú ÏßúÏó¨ ÏûàÏúºÎ©¥ PythonÏùÑ ÏÑ§ÏπòÌï¥Ïïº ÌïòÎäî Í≤ÉÏ≤òÎüº, DockerfileÏùÄ Í∑∏Îü∞ Í≤ÉÎì§ÏùÑ ÏûêÎèôÏúºÎ°ú ÏÑ§Ï†ïÌï¥Ï£ºÎäî ÌååÏùºÏù¥ÎùºÍ≥† Ïù¥Ìï¥ÌïòÎ©¥ ÎêúÎã§.

**A. Î≤†Ïù¥Ïä§ Ïù¥ÎØ∏ÏßÄ ÏÑ§Ï†ï**: Î∂ïÏñ¥ÎπµÏùÑ ÎßåÎì§ Îïå Ïñ¥Îñ§ ÎßõÏùò Î∞òÏ£ΩÏùÑ Ïì∏ÏßÄ Ï†ïÌïòÎäî Í∞úÎÖêÏúºÎ°ú PythonÏù¥ÎÇò Ubuntu Í∞ôÏùÄ Í∏∞Î≥∏ Ïù¥ÎØ∏ÏßÄÎ•º ÏÑ§Ï†ïÌïúÎã§!

**B. ÌïÑÏöîÌïú ÌîÑÎ°úÍ∑∏Îû® ÏÑ§Ïπò**: Î∂ïÏñ¥Îπµ Î∞òÏ£ΩÏóê ÌïÑÏöîÌïú Ïû¨Î£åÎ•º ÎÑ£Îäî Í≤ÉÍ≥º Í∞ôÎã§! ÌîÑÎ°úÍ∑∏Îû®Ïù¥ Ïã§ÌñâÎêòÍ∏∞ ÏúÑÌï¥ ÌïÑÏöîÌïú¬†**ÎùºÏù¥Î∏åÎü¨Î¶¨ÎÇò Ìå®ÌÇ§ÏßÄ**Î•º ÏÑ§ÏπòÌï† Ïàò ÏûàÎã§Îäî ÎúªÏúºÎ°ú ÏòàÎ•º Îì§Ïñ¥, Î∂ïÏñ¥Îπµ Î∞òÏ£ΩÏóê Ï¥àÏΩúÎ¶ø Ïπ©ÏùÑ ÎÑ£ÎìØ, ÌîÑÎ°úÍ∑∏Îû®Ïóê ÌïÑÏöîÌïú ÎùºÏù¥Î∏åÎü¨Î¶¨Î•º Ï∂îÍ∞ÄÌïúÎã§!

**C. Ïã§Ìñâ Î™ÖÎ†πÏñ¥**: Î∂ïÏñ¥ÎπµÏù¥ ÏôÑÏÑ±Îêú ÌõÑÏóê Ïñ¥ÎñªÍ≤å Íµ¨Ïö∏ÏßÄ Ï†ïÌïòÎäî Í≤ÉÏ≤òÎüº Ïª®ÌÖåÏù¥ÎÑàÍ∞Ä ÏºúÏ°åÏùÑ Îïå Ïñ¥Îñ§ ÌîÑÎ°úÍ∑∏Îû®ÏùÑ Ïã§ÌñâÌï†ÏßÄ ÏÑ§Ï†ïÌï† Ïàò ÏûàÎã§! ÏòàÎ•º Îì§Ïñ¥ Î∂ïÏñ¥ÎπµÏùÑ ÍµΩÎäî Ïò®ÎèÑÏôÄ ÏãúÍ∞ÑÏùÑ Ï†ïÌï† Ïàò ÏûàÎäî Í≤ÉÏ≤òÎüº ÌîÑÎ°úÍ∑∏Îû® Ïó≠Ïãú ÏûêÎèôÏúºÎ°ú Ïã§ÌñâÎê† Î™ÖÎ†πÏñ¥Î•º ÏÑ§Ï†ïÌï† Ïàò ÏûàÎã§!

---

DockrfileÏùÄ Ïö∞Î¶¨Í∞Ä Ìï¥Îãπ ÌîÑÎ°úÍ∑∏Îû®ÏùÑ ÎèåÏïÑÍ∞ÄÍ≤å Ìï† Ïàò ÏûàÎäî Í∏∞Î≥∏ ÌôòÍ≤ΩÏùÑ ÎßåÎì§Ïñ¥Ï£ºÎäî ÌååÏùºÎ°ú Î≤†Ïù¥Ïä§ Ïù¥ÎØ∏ÏßÄÎ•º ÏÑ§Ï†ïÌïòÍ≥†, ÌïÑÏöîÌïú Ìå®ÌÇ§ÏßÄÎèÑ ÏÑ§Ï†ïÌïòÍ≥†, Ïã§Ìñâ Î™ÖÎ†πÏñ¥ÎèÑ ÏßÅÏ†ë ÏÑ§Ï†ïÌï† Ïàò ÏûàÎã§Í≥† Î∞∞Ïõ†Îã§. ÏïÑÎûò ÏÇ¨ÏßÑÏùÄ ÏúÑÏóêÏÑú Ïö∞Î¶¨Í∞Ä Ïª®ÌÖåÏù¥ÎÑà Ïù¥ÎØ∏ÏßÄÎ°ú ÏÇ¨Ïö©Ìïú Kaggle R Ïù¥ÎØ∏ÏßÄÏùò DockerfileÏù¥Îã§. `RUN, ADD, ENV, ARG, LABEL, CMD` Í∞ôÏùÄ Î™ÖÎ†πÏñ¥Îì§Î°ú ÌååÏùºÏù¥ Íµ¨ÏÑ±ÎêòÏñ¥ ÏûàÎäî Í±∏ ÌôïÏù∏Ìï† Ïàò ÏûàÎäîÎç∞ Ïù¥Îì§Ïùò Í∏∞Îä•ÏùÑ ÌïòÎÇòÏî© Ï†ïÎ¶¨Ìï¥Î≥¥ÎèÑÎ°ù ÌïòÏûê!

<img src="{{ '/assets/p.14/p14.3.png' | relative_url }}" alt="Descriptive Alt Text" />

---

<h4>üíª Related Commands</h4>

‚úÖ¬†`ADD` : Î°úÏª¨ Ìò∏Ïä§Ìä∏ ÎÇ¥ ÌååÏùºÏù¥ÎÇò Ìè¥ÎçîÎ•º Docker Ïù¥ÎØ∏ÏßÄÎ°ú Î≥µÏÇ¨

- Î°úÏª¨ ÌååÏùºÏùÑ Ïª®ÌÖåÏù¥ÎÑàÎ°ú Î≥µÏÇ¨ÌïòÍ±∞ÎÇò URLÏóêÏÑú ÌååÏùºÏùÑ Í∞ÄÏ†∏Ïò¨ ÏàòÎèÑ ÏûàÍ≥† ÎßåÏïΩ Ìï¥Îãπ ÌååÏùºÏù¥ ÏïïÏ∂ïÌååÏùºÏùº Í≤ΩÏö∞ ÏûêÎèôÏúºÎ°ú ÌíÄÎ¶¨Í∏∞ÎèÑ Ìï®
- `ADD kaggle/ /kaggle/`
    - Î°úÏª¨ Ìò∏Ïä§Ìä∏Ïùò `kaggle/` Ìè¥ÎçîÎ•º Ïª®ÌÖåÏù¥ÎÑàÏùò `/kaggle/` Ìè¥ÎçîÎ°ú Î≥µÏÇ¨

‚úÖ¬†`RUN` : Ïù¥ÎØ∏ÏßÄÎ•º ÎπåÎìúÌï† Îïå Ïã§ÌñâÌï† Î™ÖÎ†πÏñ¥Î•º ÏßÄÏ†ï

- Ï£ºÎ°ú ÌîÑÎ°úÍ∑∏Îû®ÏùÑ ÏÑ§ÏπòÌïòÍ±∞ÎÇò Ïä§ÌÅ¨Î¶ΩÌä∏Î•º Ïã§ÌñâÌï† Îïå ÏÇ¨Ïö©ÎêòÍ≥†, Ïù¥ Î™ÖÎ†πÏñ¥Î•º Ïì∏ ÎïåÎßàÎã§ ÏÉàÎ°úÏö¥ Î†àÏù¥Ïñ¥Í∞Ä ÎßåÎì§Ïñ¥Ïßê!
- ü§î¬†‚ÄôÏÉàÎ°úÏö¥ Î†àÏù¥Ïñ¥Í∞Ä ÎßåÎì§Ïñ¥ÏßÑÎã§‚ÄôÎäî ÎúªÏùÄ ÎèÑÏª§Ïùò Ïù¥ÎØ∏ÏßÄ Í¥ÄÎ¶¨ Ï∏°Î©¥ÏóêÏÑú Ïù¥Ìï¥Ìï¥Ïïº ÌïòÎäîÎç∞, Docker Ïù¥ÎØ∏ÏßÄÎäî Ïó¨Îü¨ Í∞úÏùò ÏùΩÍ∏∞ Ï†ÑÏö© Î†àÏù¥Ïñ¥Î°ú Ïù¥Î£®Ïñ¥Ï†∏ ÏûàÏñ¥ Í∞Å Î†àÏù¥Ïñ¥Îäî Ïù¥Ï†Ñ Î†àÏù¥Ïñ¥Ïùò Î≥ÄÍ≤Ω ÏÇ¨Ìï≠ÏùÑ Í∏∞ÏñµÌïúÎã§. ÏòàÎ•º Îì§Ïñ¥ ÌïòÎÇòÏùò Ïù¥ÎØ∏ÏßÄÎ•º ÎπåÎìúÌï† Îïå **Ïö∞Î∂ÑÌà¨ Ïö¥ÏòÅÏ≤¥Ï†ú ‚Üí Ìå®ÌÇ§ÏßÄ ÏÑ§Ïπò ‚Üí ÌååÏùº Î≥µÏÇ¨** Îã®Í≥ÑÎ•º Í±∞ÏπòÍ≤å ÎêòÎäîÎç∞ Ïù¥ Ìïú Ïä§ÌÖùÏùÑ Ïù¥ Î†àÏù¥Ïñ¥(layer)Í∞Ä Í¥ÄÎ¶¨ÌïúÎã§Îäî ÏùòÎØ∏Îã§! Ìö®Ïú®ÏÑ±, Ï∫êÏã±ÏùÑ Í≥†Î†§ÌñàÏùÑ Îïå Îß§Ïö∞ Ìï©Î¶¨Ï†ÅÏù∏ Î∞©Î≤ïÏûÑÏù¥ Î∂ÑÎ™ÖÌïúÎç∞ ÏÉàÎ°úÏö¥ RUN Î™ÖÎ†πÏùÑ Ïã§ÌñâÌï† ÎïåÎßàÎã§ ÏÉàÎ°úÏö¥ Î†àÏù¥Ïñ¥Í∞Ä ÏÉùÏÑ±ÎêòÍ∏∞ ÎïåÎ¨∏Ïóê, Î∂àÌïÑÏöîÌïú RUN Î™ÖÎ†πÏñ¥Î•º ÎßéÏù¥ ÏÇ¨Ïö©ÌïòÎ©¥ Ïù¥ÎØ∏ÏßÄÍ∞Ä Î∂àÌïÑÏöîÌïòÍ≤å Ïª§Ïßà Ïàò ÏûàÎã§. Îî∞ÎùºÏÑú **Ïó¨Îü¨ Î™ÖÎ†πÏùÑ Ìïú RUN Î™ÖÎ†πÏñ¥Ïóê Î¨∂Ïñ¥ÏÑú Ïã§Ìñâ**ÌïòÎäî Í≤ÉÏùÑ Ï∂îÏ≤úÌï®!üëç
- `RUN R -e "keras::install_keras(tensorflow = \"${TENSORFLOW_VERSION}\", extra_packages = c(\"pandas\"))"`
    - RÏùÑ Ïã§ÌñâÌï¥ÏÑú `keras`, `tensorflow`, `pandas` Í∞ôÏùÄ Ìå®ÌÇ§ÏßÄÎ•º ÏÑ§ÏπòÌï®

‚úÖ¬†`ENV` : Ïª®ÌÖåÏù¥ÎÑà ÏïàÏóêÏÑú ÏÇ¨Ïö©Ìï† ÌôòÍ≤Ω Î≥ÄÏàòÎ•º ÏÑ§Ï†ï(docker run)

- Ïù¥ Î™ÖÎ†πÏúºÎ°ú ÏÑ§Ï†ïÎêú ÌôòÍ≤Ω Î≥ÄÏàòÎäî Docker Ïù¥ÎØ∏ÏßÄ ÎπåÎìú ÌõÑ Ïª®ÌÖåÏù¥ÎÑà Ïã§Ìñâ ÏãúÏóêÎèÑ Ïú†ÏßÄÍ∞Ä Í∞ÄÎä•Ìï®
- `ENV R_HOME=/usr/local/lib/R`
    - `R_HOME`Ïù¥ÎùºÎäî ÌôòÍ≤Ω Î≥ÄÏàòÎ•º `/usr/local/lib/R`Î°ú ÏÑ§Ï†ï

‚úÖ¬†`ARG` : Ïù¥ÎØ∏ÏßÄ ÎπåÎìú(docker build) ÏãúÏóê ÏÇ¨Ïö©Ìï† Î≥ÄÏàò Ï†ïÏùò

- `ARG`Î°ú Ï†ïÏùòÎêú Î≥ÄÏàòÎäî ÎπåÎìú ÌÉÄÏûÑ(Ïù¥ÎØ∏ÏßÄÎ•º ÎßåÎì§ Îïå)ÍπåÏßÄÎßå ÏÇ¨Ïö©ÎêòÍ≥† Ïã§ÌñâÎê† ÎïåÎäî ÏÇ¨Ïö©Ìï† Ïàò ÏóÜÏùå
- `ARG GIT_COMMIT=unknown
ARG BUILD_DATE_RSTATS=unknown`
    - `GIT_COMMIT`Í≥º `BUILD_DATE_RSTATS`ÎùºÎäî Ïù¥Î¶ÑÏùÑ Í∞ÄÏßÄÍ≥† ÏûàÍ≥†, Í∏∞Î≥∏Í∞íÏùÄ 'unknown'

‚úÖ¬†`LABEL` : Ïù¥ÎØ∏ÏßÄÏóê Î©îÌÉÄÎç∞Ïù¥ÌÑ∞(Ïù¥ÎØ∏ÏßÄÎ•º ÏÑ§Î™ÖÌïòÎäî Ï†ïÎ≥¥)Î•º Ï∂îÍ∞ÄÌï®

- Ïù¥ÎØ∏ÏßÄÎ•º ÎßåÎì† ÎÇ†ÏßúÎÇò Ïª§Î∞ã Ï†ïÎ≥¥ Îì±ÏùÑ ÎÑ£Ïñ¥ÏÑú Î≤ÑÏ†Ñ Í¥ÄÎ¶¨Ïóê ÎèÑÏõÄÏù¥ ÎèºÏöî. key-value ÌòïÏãùÏúºÎ°ú Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû•
- `LABEL git-commit=$GIT_COMMIT
LABEL build-date=$BUILD_DATE_RSTATS`
    - `git-commit`Í≥º `build-date`ÎùºÎäî Ïù¥Î¶ÑÏúºÎ°ú `GIT_COMMIT`Í≥º `BUILD_DATE_RSTATS` Í∞íÏùÑ ÎùºÎ≤®Î°ú ÏßÄÏ†ïÌï®

‚úÖ¬†`CMD` : Ïª®ÌÖåÏù¥ÎÑàÍ∞Ä ÏãúÏûëÎê† Îïå Í∏∞Î≥∏Ï†ÅÏúºÎ°ú Ïã§ÌñâÌï† Î™ÖÎ†πÏùÑ ÏßÄÏ†ï

- `docker run` Î™ÖÎ†πÏñ¥Î°ú Ïª®ÌÖåÏù¥ÎÑàÎ•º Ïã§ÌñâÌï† Îïå, Ï∂îÍ∞Ä Î™ÖÎ†πÏùÑ ÏßÄÏ†ïÌïòÏßÄ ÏïäÏúºÎ©¥ CMDÏóêÏÑú Ï†ïÌïú Î™ÖÎ†πÏñ¥Í∞Ä Ïã§ÌñâÎê®
- `CMD ["R"]`
    - Ïù¥ Î™ÖÎ†πÏñ¥Îäî Ïª®ÌÖåÏù¥ÎÑàÍ∞Ä ÏãúÏûëÎê† Îïå Í∏∞Î≥∏Ï†ÅÏúºÎ°ú R ÌîÑÎ°úÍ∑∏Îû®ÏùÑ Ïã§Ìñâ

---

Ïù¥Î†áÍ≤å Ï†ïÎ¶¨Ìï¥Î¥§ÎäîÎç∞, ÏßÄÍ∏à Ïù¥ Í∏ÄÏùÑ ÏùΩÍ≥† ÏûàÎäî Î∂ÑÏù¥ ÏûàÎã§Î©¥ Ïù¥Ìï¥Í∞Ä ÎêòÎäîÏßÄ Í±±Ï†ïÏù¥Îã§. ÏÇ¨Ïã§ Î™ÖÎ†πÏñ¥ Í∞úÎÖê Í∞ôÏùÄ Î∂ÄÎ∂ÑÏùÄ Ïã§Ï†úÎ°ú ÎÇ¥Í∞Ä ÏßÅÏ†ë Ïã§ÏäµÏùÑ Ìï¥Î≥¥ÎäîÍ≤å Í∞ÄÏû• Îπ†Î•∏ Ïù¥Ìï¥ Î£®Ìä∏ÎùºÍ≥† ÏÉùÍ∞ÅÌïòÎã§. Í∑∏ÎûòÏÑú ÎÇò Ïó≠Ïãú ÏúÑÏóêÏÑú ÏÑ§ÏπòÌïú Kaggle RStudioÏùò ÎèÑÏª§ÌååÏùºÏùÑ Î∂ÑÏÑùÌï¥Î≥¥Í∏∞Î°ú ÌñàÎã§. 

ÏïÑÎûò ÏΩîÎìúÎäî RStudio ÏÑúÎ≤Ñ ÌôòÍ≤ΩÏùÑ Íµ¨Ï∂ïÌïòÍ∏∞ ÏúÑÌï¥ ÏûëÏÑ±Îêú DockerfileÏù¥Îã§. Í∞ÑÎã®Ìûà ÏÇ¥Ìé¥Î≥¥Î©¥ `FROM gcr.io/kaggle-gpu-images/rstats:${rstats_version}` ÏùÑ ÌÜµÌï¥ Î≤†Ïù¥Ïä§ Ïù¥ÎØ∏ÏßÄ([gcr.io/kaggle-gpu-images/rstats](http://gcr.io/kaggle-gpu-images/rstats))Î•º ÏÑ§Ï†ïÌïòÍ≥† ÏûàÎã§. Ïù¥Îäî Kaggle GPU Ïù¥ÎØ∏ÏßÄÎ•º Í∏∞Î∞òÏúºÎ°ú ÌïòÏó¨ RÍ≥º RStudio ÏÑúÎ≤ÑÎ•º ÏÇ¨Ïö©Ìï† Ïàò ÏûàÍ≤å Ìï¥Ï§ÄÎã§. Î∞îÎ°ú Î∞ëÏùò `RUN` Î∂ÄÎ∂ÑÎèÑ Ï§ëÏöîÌïúÎç∞, Îí§Ïùò Î™ÖÎ†πÏñ¥Îì§ÏùÑ ÌÜµÌï¥ Ïã§ÏßàÏ†ÅÏúºÎ°ú RStudio ÏÑúÎ≤ÑÎ•º Îã§Ïö¥Î°úÎìú ÌõÑ ÏÑ§ÏπòÌïòÍ≥† ÏûàÎã§. Í¥ÄÎ†® Î™ÖÎ†πÏñ¥Îì§ÏùÑ Íµ¨Ï≤¥Ï†ÅÏúºÎ°ú ÏÑ§Î™ÖÌïòÏßÄÎäî ÏïäÏùÑÍ±∞ÏßÄÎßå(Í≤ÄÏÉâÏùÑ Ï∂îÏ≤úÌï©ÎãàÎã§!) ÏïÑÍπå ÏúÑÏóêÏÑú Î†àÏù¥Ïñ¥ Í∞úÎÖêÏùÑ ÏÑ§Î™ÖÌñàÎäîÎç∞ Ïó∞Ïû•ÏÑ†ÏúºÎ°ú `&&` Î•º ÏÇ¨Ïö©Ìï¥ Î†àÏù¥Ïñ¥Î•º Ï§ÑÏù¥Í≥† ÏûàÎã§Îäî Ï†êÎèÑ ÌôïÏù∏ Í∞ÄÎä•ÌïòÎã§!

`WORKDIR /home/rstudio` ÏúÑÏóêÏÑú Îã§Î£¨ Î™ÖÎ†πÏñ¥Îäî ÏïÑÎãàÏßÄÎßå Îã®Ïñ¥ÏóêÏÑú Ïú†Ï∂îÌï† Ïàò ÏûàÎìØÏù¥ Íµ¨Ï≤¥Ï†ÅÏúºÎ°ú ÏûëÏóÖ ÎîîÎ†âÌÜ†Î¶¨Î•º ÏÑ§Ï†ïÌï¥ Ï§Ñ ÏàòÎèÑ ÏûàÎã§. 

`USER rstudio` Î•º ÌÜµÌï¥ Ìï¥Îãπ Ïª®ÌÖåÏù¥ÎÑàÏùò ÏÇ¨Ïö©ÏûêÎ•º ‚Äòrstudio‚ÄôÎ°ú ÏßÄÏ†ïÌï¥ Ï£ºÏóàÎã§. Í∏∞Î≥∏Ï†ÅÏúºÎ°ú DockerÎäî `root` ÏÇ¨Ïö©ÏûêÎ°ú Ïã§ÌñâÎêúÎã§. Îã§Îßå Î≥¥ÏïàÏù¥ÎÇò ÌååÏùº Í∂åÌïú Î¨∏Ï†úÎ°ú Ïù∏Ìï¥ ÌäπÏ†ï ÏûëÏóÖÏùÑ ÏùºÎ∞ò ÏÇ¨Ïö©ÏûêÎ°ú ÏßÄÏ†ïÌïòÎäî Í≤ΩÏö∞Í∞Ä ÎßéÏùÄÎç∞ Ïù¥ Îïå `USER` Î™ÖÎ†πÏñ¥Î•º Ïù¥Ïö©Ìï¥ Í∂åÌïúÏùÑ Î∞îÍøîÏ§Ñ Ïàò ÏûàÎã§. 

Í∑∏ Ïô∏ÏóêÎäî ÏúÑÏóêÏÑú Îã§Î§òÎçò Ìè¨Ìä∏Í∞Ä ÎààÏóê ÎùÑÎäîÎç∞ `EXPOSE 8787` ÏßÄÏ†ïÌï¥Ï£ºÎ©¥ÏÑú RStudio Server Ï™ΩÏóê 8787Î≤à Ìè¨Ìä∏Î•º Ïó¥Ïñ¥Ï£ºÏóàÎã§.

üëá¬†**RStudio server .Dockerfile**

```
  RG rstats_version=v56 

#base image(ÎèÑÏª§ÌååÏùºÏùò Í∏∞Î≥∏ Î≤†Ïù¥Ïä§)Îäî fromÏúºÎ°ú Î∂àÎü¨Ïò§Í∏∞
FROM gcr.io/kaggle-gpu-images/rstats:${rstats_version} 
ARG rstudio_version=2021.09.0-351
RUN apt-get update && \
    apt-get install -y gdebi-core && \
    wget https://download2.rstudio.org/server/focal/amd64/rstudio-server-${rstudio_version}-amd64.deb && \ 
    gdebi -n rstudio-server-${rstudio_version}-amd64.deb && \ 
    apt-get clean && \
    rm rstudio-server-${rstudio_version}-amd64.deb

WORKDIR /home/rstudio
COPY setup.R ./setup.R
RUN chown rstudio:rstudio ./setup.R
RUN chmod +x ./setup.R
USER rstudio
RUN Rscript ./setup.R && \
    rm ./setup.R
USER root


EXPOSE 8787
# LABEL revised_by="Daniel Youk" \
#       revised_date="2023-12-24"
ENTRYPOINT [ "/bin/bash"]
CMD ["-c", "rstudio-server start && tail -f /dev/null"]

```

Í∑∏Î¶¨Í≥† ÌïúÍ∞ÄÏßÄ Ï§ëÏöîÌïú Ï†êÏùÄ `CMD ["-c", "rstudio-server start && tail -f /dev/null"]` Ïù¥ Î™ÖÎ†πÏñ¥Îã§. ÏúÑÏóêÏÑú `CMD` Î•º ‚ÄòÏª®ÌÖåÏù¥ÎÑàÍ∞Ä ÏãúÏûëÎê† Îïå Í∏∞Î≥∏Ï†ÅÏúºÎ°ú Ïã§ÌñâÌï† Î™ÖÎ†πÏùÑ ÏßÄÏ†ï‚ÄôÌïúÎã§Í≥† ÏÑ§Î™ÖÌñàÎã§. Ïù¥ Î∂ÄÎ∂ÑÏùÄ ÎÇ¥ Í≤ΩÌóò ÏÉÅ ÏòàÏãú ÌïòÎÇòÏùò ÎπÑÍµêÎ•º ÌÜµÌï¥ Î∞îÎ°ú Ïù¥Ìï¥Í∞Ä Í∞ÄÎä•ÌñàÎã§. 

ÏïÑÎûò ÏÇ¨ÏßÑÏùÄ ÏúÑÏóêÏÑú Îã§Î£¨ Kaggle R Ïù¥ÎØ∏ÏßÄÏùò DockerfileÏùò Í∞ÄÏû• ÎßàÏßÄÎßâ Ï§ÑÏùò Ï∫°Ï≥ê Î∂ÄÎ∂ÑÏù¥Îã§. Î≥¥Î©¥ `CMD [‚ÄùR‚Äù]` Ïù¥ÎùºÍ≥† Ï†ÅÌòÄÏûàÎäîÎç∞, `CMD` Î°ú Ïª®ÌÖåÏù¥ÎÑà ÏãúÏûë Î™ÖÎ†πÏñ¥Î•º ÏßÄÏ†ïÌï† Ïàò ÏûàÍ∏∞ ÎïåÎ¨∏Ïóê Ìï¥Îãπ Ïª®ÌÖåÏù¥ÎÑàÎ•º Ïã§ÌñâÌïòÍ∏∞ ÏúÑÌïú Í∏∞Î≥∏ Î™ÖÎ†πÏñ¥(docker exec)Î•º ÏùëÏö©Ìï¥  `docker exec -it rstudio-container R` Ïù¥Î†áÍ≤å ÏÇ¨Ïö©Ìï† Ïàò ÏûàÎã§. Ïù¥ Î™ÖÎ†πÏñ¥Î°ú Î∞îÎ°ú  rstudio-containerÏùò R ÌîÑÎ°úÍ∑∏Îû®Ïóê Ï†ëÍ∑ºÌï† Ïàò ÏûàÎäî Í≤ÉÏù¥Îã§. 

<img src="{{ '/assets/p.14/p14.3.1.png' | relative_url }}" alt="Descriptive Alt Text" />

<img src="{{ '/assets/p.14/p14.6.png' | relative_url }}" alt="Descriptive Alt Text" />

Í∑∏Îü∞Îç∞ RStudio ServerÎ•º Íµ¨Ï∂ïÌïòÎäî ÎèÑÏª§ÌååÏùºÏóêÎèÑ `CMD` Î™ÖÎ†πÏñ¥Í∞Ä ÏûàÎã§. Í∑∏Îü∞Îç∞ Î∂ÑÎ™Ö ÏÉùÍπÄÏÉàÍ∞Ä Îã§Î•∏ Í±∏Î°ú Î≥¥ÏïÑ Ï∞®Ïù¥Ï†êÏù¥ ÏûàÎäî Í≤ÉÏù¥ ÌôïÏã§ÌïòÎã§.(Î≠êÏßÄ..) Í≤∞Î°†Î∂ÄÌÑ∞ ÎßêÌïòÏûêÎ©¥ `CMD ["-c", "rstudio-server start && tail -f /dev/null"]` Î™ÖÎ†πÏñ¥Îäî RStudio ÏÑúÎ≤ÑÎ•º ÏãúÏûëÌïòÍ≥† Ïª®ÌÖåÏù¥ÎÑàÍ∞Ä Ï¢ÖÎ£åÎêòÏßÄ ÏïäÍ≤å Ïú†ÏßÄÌïòÎäî Í∏∞Îä•ÏùÑ ÌïúÎã§. `/dev/null`ÏùÄ Î¶¨ÎàÖÏä§ ÏãúÏä§ÌÖúÏóêÏÑú ÌäπÎ≥ÑÌïú ÌååÏùºÎ°ú ÏûÖÎ†•Îêú Îç∞Ïù¥ÌÑ∞Î•º Î™®Îëê Î≤ÑÎ¶¨Îäî Ïó≠Ìï†ÏùÑ ÌïòÎäîÎç∞ `tail -f` Î™ÖÎ†πÏñ¥Î°ú `/dev/null` ÌååÏùºÏùÑ Í≥ÑÏÜç Ï∞æÏúºÎ†§Í≥† ÌïúÎã§. ÌïòÏßÄÎßå Ìï¥Îãπ ÌååÏùºÏùÄ ÏïûÏÑú ÎßêÌñàÎìØÏù¥ Î¨¥Ïñ∏Í∞Ä ÏûÖÎ†•ÎêòÎ©¥ Îç∞Ïù¥ÌÑ∞Î•º Î™®Îëê Î≤ÑÎ¶¨Îäî Ïó≠Ìï†ÏùÑ ÌïòÍ∏∞ ÎïåÎ¨∏Ïóê Î¨¥ÌïúÎ£®ÌîÑÏóê Îπ†ÏßÄÍ≤å ÎêòÍ≥† Ïª®ÌÖåÏù¥ÎÑàÍ∞Ä Ï¢ÖÎ£åÎêòÏßÄ ÏïäÍ≤å Ïú†ÏßÄÌïòÎäî Í∏∞Îä•ÏùÑ Ìï† Ïàò ÏûàÎäî Í≤ÉÏù¥Îã§!

<h4>3.1 Difference Between Docker CMD and ENTRYPOINT: When and How to Use Them?</h4>

DockerfileÏùÑ ÏûëÏÑ±Ìï† Îïå CMDÏôÄ ENTRYPOINT Îëê Î™ÖÎ†πÏñ¥Í∞Ä Í≥ÑÏÜç ÎÇòÏôîÎã§. **ÎëòÎã§ Ïª®ÌÖåÏù¥ÎÑàÍ∞Ä ÏãúÏûëÎê† Îïå Ïã§ÌñâÎê† Î™ÖÎ†πÏùÑ ÏßÄÏ†ï**ÌïòÎäî Îç∞ ÏÇ¨Ïö©ÎêòÎäî Í±¥ ÎòëÍ∞ôÏßÄÎßå Í∑∏ Ïó≠Ìï†Í≥º ÎèôÏûë Î∞©ÏãùÏóê Ï∞®Ïù¥Í∞Ä ÏûàÎäî Í≤É Í∞ôÎã§. Ïù¥ Î∂ÄÎ∂ÑÎèÑ Îã§ÏãúÎäî Ìó∑Í∞àÎ¶¨Í∏∞ Ïã´ÏúºÎãà Ïó¨Í∏∞ÏÑú Ï†ïÎ¶¨Ìï¥ Î≥¥Î†§Í≥† ÌïúÎã§!

<h4>üö™¬†CMD</h4>

Í≥ÑÏÜç Ïñ∏Í∏âÎêòÏóàÎçò CMDÎäî Ïª®ÌÖåÏù¥ÎÑàÍ∞Ä Ïã§ÌñâÎê† ÎïåÎßàÎã§ ÏàòÌñâÎêòÏßÄÎßå ÎçÆÏñ¥Ïì∞Í∏∞Í∞Ä Í∞ÄÎä•ÌïòÎã§. ÎßåÏïΩ ÏÇ¨Ïö©ÏûêÍ∞Ä `docker run` Î™ÖÎ†πÏñ¥Î•º Ïã§ÌñâÌïòÎ©¥ÏÑú Îã§Î•∏ Î™ÖÎ†πÏùÑ ÏûÖÎ†•ÌïòÎ©¥ CMDÏóêÏÑú ÏßÄÏ†ïÌïú Î™ÖÎ†πÏùÄ Ïã§ÌñâÎêòÏßÄ ÏïäÍ≥† ÏÉàÎ°ú ÏûÖÎ†•Ìïú Î™ÖÎ†πÏù¥ ÎåÄÏã† Ïã§ÌñâÏù¥ Í∞ÄÎä•ÌïòÎã§. ÏòàÏãúÎ•º ÌÜµÌï¥ Ïù¥Ìï¥Ìï¥Î≥¥ÎèÑÎ°ù ÌïòÏûê!

Ïö∞Î¶¨Îäî `CMD ["R"]` Ïù¥ ÏΩîÎìúÎ•º Ïù¥Ïö©Ìï¥ Ïª®ÌÖåÏù¥ÎÑàÍ∞Ä ÏãúÏûëÎêòÎ©¥ R ÏΩòÏÜîÏù¥ Í∏∞Î≥∏ÏúºÎ°ú Ïã§ÌñâÎê®ÏùÑ ÏúÑÏóêÏÑú ÌôïÏù∏ÌñàÎã§. Í∑∏Îü∞Îç∞ ÎßåÏïΩ ÏÇ¨Ïö©ÏûêÍ∞Ä Ïª®ÌÖåÏù¥ÎÑàÎ•º Ïã§Ìñâ ÌïòÎ©¥ÏÑú Îã§Î•∏ Î™ÖÎ†πÏùÑ ÏûÖÎ†•ÌïúÎã§Î©¥ CMDÏóêÏÑú ÏßÄÏ†ïÌïú `R`ÏùÄ Î¨¥ÏãúÎêòÍ≥† ÏÉàÎ°úÏö¥ Î™ÖÎ†πÏù¥ Ïã§ÌñâÎêúÎã§. Ïù¥Í≤å Î¨¥Ïä® ÎßêÏù∏Í∞Ä ÌïòÎ©¥ `docker run <image> /bin/bash` Î°ú Î™ÖÎ†πÏñ¥Î•º Ïã§ÌñâÌïòÎ©¥ `R` ÎåÄÏã† `/bin/bash`Í∞Ä Ïã§Ìñâ ÎêúÎã§Îäî ÎßêÏù¥Îã§.

<h4>üö™¬†Entry Point</h4>

ENTRYPOINTÎäî Ìï≠ÏÉÅ Ïã§ÌñâÎê† Î™ÖÎ†πÏùÑ ÏßÄÏ†ïÌïòÎäî Îç∞ ÏÇ¨Ïö©ÎêúÎã§. CMDÏôÄ Îã¨Î¶¨ `docker run`ÏóêÏÑú Îã§Î•∏ Î™ÖÎ†πÏùÑ ÏûÖÎ†•Ìï¥ÎèÑ ENTRYPOINTÏóêÏÑú ÏßÄÏ†ïÌïú Î™ÖÎ†πÏùÄ ÎçÆÏñ¥Ïì∞Ïù¥ÏßÄ ÏïäÏúºÎ©∞ Í∑∏ÎåÄÎ°ú Ïã§ÌñâÎêòÎäî Í≤å ÎëòÏùò Í∞ÄÏû• ÌÅ∞ ÌäπÏßïÏù¥Îã§. Ïù¥Í≤ÉÎèÑ ÏòàÏãúÎ•º ÌÜµÌï¥ Ïù¥Ìï¥Ìï¥Î≥¥Î°ù ÌïòÏûê!

`ENTRYPOINT ["/bin/bash", "-c"]` Ïù¥ ÏΩîÎìúÎäî Ïª®ÌÖåÏù¥ÎÑàÍ∞Ä Ïã§ÌñâÎê† Îïå Ìï≠ÏÉÅ <code>/bin/bash -c</code>Î•º Ïã§ÌñâÌïòÎèÑÎ°ù ÌïúÎã§. Í∑∏Îü∞Îç∞ ÎßåÏïΩ ÏÇ¨Ïö©ÏûêÍ∞Ä `docker run`ÏùÑ Ïù¥Ïö©Ìï¥ `docker run <image> "echo Hello"`Î•º Ïã§ÌñâÌïòÎ©¥ Í∑∏ Î™ÖÎ†πÏùÄ <code>/bin/bash -c</code> Ïùò Ïù∏ÏûêÎ°ú Ï†ÑÎã¨ÎêòÏñ¥ <code>/bin/bash -c "echo Hello"</code>Î°ú Ïã§ÌñâÎêúÎã§!


üëá¬†**summary**

<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CMD vs ENTRYPOINT</title>
    <style>
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            border: 1px solid #dddddd;
            text-align: left;
            padding: 8px;
        }
        th {
            background-color: #99CCFF;
        }
        td {
            vertical-align: top;
        }
    </style>
</head>
<body>

<table>
    <thead>
        <tr>
            <th>Ìï≠Î™©</th>
            <th>CMD</th>
            <th>ENTRYPOINT</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Î™©Ï†Å</td>
            <td>Í∏∞Î≥∏ Î™ÖÎ†πÏùÑ ÏÑ§Ï†ï (ÎçÆÏñ¥Ïì∞Í∏∞ Í∞ÄÎä•)</td>
            <td>ÌïÑÏàò Î™ÖÎ†πÏùÑ ÏÑ§Ï†ï (Ìï≠ÏÉÅ Ïã§ÌñâÎê®)</td>
        </tr>
        <tr>
            <td>ÎçÆÏñ¥Ïì∞Í∏∞</td>
            <td>`docker run` Î™ÖÎ†πÏñ¥Î°ú ÎçÆÏñ¥ÏîåÏõÄ</td>
            <td>ÎçÆÏñ¥Ïì∞ÏßÄ ÏïäÍ≥†, Ïù∏ÏûêÎ•º Ï†ÑÎã¨ Í∞ÄÎä•</td>
        </tr>
        <tr>
            <td>Ïú†Ïó∞ÏÑ±</td>
            <td>Îã§Î•∏ Î™ÖÎ†πÏúºÎ°ú ÎåÄÏ≤¥Ìï† Ïàò ÏûàÏùå</td>
            <td>Ïù∏ÏûêÎ•º ÌÜµÌï¥ Î™ÖÎ†π Ï∂îÍ∞Ä Í∞ÄÎä•</td>
        </tr>
        <tr>
            <td>ÏòàÏãú</td>
            <td>`CMD ["R"]`</td>
            <td>`ENTRYPOINT ["/bin/bash", "-c"]`</td>
        </tr>
    </tbody>
</table>

</body>
</html>

Í≤∞Î°†Ï†ÅÏúºÎ°ú Îëê Î™ÖÎ†πÏñ¥ Î™®Îëê Ïª®ÌÖåÏù¥ÎÑàÍ∞Ä ÏãúÏûëÎê† Îïå Ïã§ÌñâÎê† Î™ÖÎ†πÏùÑ ÏßÄÏ†ïÌïòÏßÄÎßå CMDÎäî Í∏∞Î≥∏ Ïã§Ìñâ Î™ÖÎ†πÏùÑ, ENTRYPOINTÎäî Ìï≠ÏÉÅ Ïã§ÌñâÎêòÏñ¥Ïïº ÌïòÎäî ÌïÑÏàò Î™ÖÎ†πÏùÑ ÏÑ§Ï†ïÌïòÎäî Îç∞ ÏÇ¨Ïö©ÎêúÎã§Îäî Ï†êÏùÑ Íº≠Í∏∞ÏñµÌïòÍ∏∏ Î∞îÎûÄÎã§! ÏïÑÎûò ÏΩîÎìúÎäî Ïã§Ï†ú ÌîÑÎ°úÏ†ùÌä∏ÏóêÏÑú ÎßéÏù¥ ÏÇ¨Ïö©ÌïòÎäî Ï°∞Ìï©Ïù¥Îãà Ï∞∏Í≥†ÌïòÎ©¥ Ï¢ãÏùÑ ÎìØ ÌïòÎã§!

```
ENTRYPOINT ["/bin/bash", "-c"]
CMD ["rstudio-server start && tail -f /dev/null"]
```

---

<h2>4. Docker Pipeline</h2>
Ïù¥Î≤à Ìè¨Ïä§ÌåÖÏùÑ ÎßàÎ¨¥Î¶¨ ÌïòÍ∏∞ Ï†ÑÏóê ÏßÄÍ∏àÍπåÏßÄÏùò ÌïôÏäµ Í≥ºÏ†ïÏùÑ ÏãúÍ∞ÅÏ†ÅÏúºÎ°ú Ï†ïÎ¶¨Ìï¥ Î≥¥Î†§Í≥† ÌïúÎã§. ÏßÄÍ∏àÍπåÏßÄÏùò Ìè¨Ïä§ÌåÖÏùÄ DockerfileÏùÑ ÌÜµÌï¥ Ïù¥ÎØ∏ÏßÄ ÏÉùÏÑ±ÌïòÍ≥† Í∑∏ Ïù¥ÎØ∏ÏßÄÎ•º ÌÜµÌï¥ Ïª®ÌÖåÏù¥ÎÑà Ïã§ÌñâÌïòÎäî Î∂ÄÎ∂ÑÍπåÏßÄ ÏßÑÌñâÎêòÏóàÎã§. (Dockerfile ‚Üí Ïù¥ÎØ∏ÏßÄ ÏÉùÏÑ± ‚Üí Registry Ï†ÄÏû• ‚Üí Ïù¥ÎØ∏ÏßÄ Í∞ÄÏ†∏Ïò§Í∏∞ ‚Üí Ïª®ÌÖåÏù¥ÎÑà Ïã§Ìñâ) 

ÏßÄÍ∏àÏù¥Ïïº Ïù¥ÎØ∏ÏßÄÎ•º ÎßåÎì§Í≥† Î°úÏª¨ÏóêÏÑú Ïã§ÌñâÌïòÎäî Îç∞ ÌÅ∞ Î¨∏Ï†úÍ∞Ä ÏóÜÏóàÎã§. ÌïòÏßÄÎßå Ïª®ÌÖåÏù¥ÎÑàÏóêÏÑú ÏÇ¨Ïö©ÌïòÎäî Ïù¥ÎØ∏ÏßÄÎì§Ïù¥ ÎßéÏïÑÏßÑÎã§Î©¥ Î°úÏª¨Ïù¥ÎùºÎäî ÌïúÏ†ïÎêú Í≥µÍ∞ÑÏóêÏÑú Ìö®Ïú®ÏÑ±Ïù¥ Îñ®Ïñ¥ÏßÄÍ≤å ÎêúÎã§. Í∑∏ÎûòÏÑú Î≥¥ÌÜµÏùÄ Docker RegistryÎùºÎäî Í≥≥Ïóê Ïù¥ÎØ∏ÏßÄÎ•º Ï†ÄÏû•(push)ÌïòÍ≥† ÌïÑÏöîÌï† ÎïåÎßàÎã§ ÎãπÍ≤®ÏôÄ(pull) Î°úÏª¨ ÌòπÏùÄ Í∞ÄÏÉÅÎ®∏Ïã†ÏóêÏÑú ÏÇ¨Ïö©ÌïòÎäî Í≤å ÏùºÎ∞òÏ†ÅÏù¥Îã§. Îã§Ïùå Ìè¨Ïä§ÌåÖ Î∂ÄÌÑ∞Îäî Ïù¥ Ïù¥ÏïºÍ∏∞Î•º Ï§ëÏã¨ÏúºÎ°ú ÏßÑÌñâÎêòÎãà Í∏∞ÎåÄÌï¥ Ï£ºÍ∏∏ Î∞îÎûÄÎã§! üòé

<img src="{{ '/assets/p.14/p14.14.png' | relative_url }}" alt="Descriptive Alt Text" />

---

*Ïù¥Î≤à Ï£ºÏ∞®Îäî ÏßÄÍ∏àÍπåÏßÄ ÎèÑÏª§Î•º Í≥µÎ∂ÄÌïòÎ©∞ ÎπÑÏú†Ï†ÅÏúºÎ°ú Ïù¥Ìï¥ÌñàÎçò Î∂ÄÎ∂ÑÎì§Ïóê ÎåÄÌï¥ Ï°∞Í∏à Îçî ÏÜåÌîÑÌä∏Ïõ®Ïñ¥ Ï∏°Î©¥ÏóêÏÑú Ïù¥Î°†ÏùÑ Îã§Î£®ÏóàÎã§. Í∑∏Îü¨Îã§Î≥¥Îãà Î≠êÎûÑÍπå.. Î∂ÑÎ™Ö ÎÇ¥Í∞Ä ÏïåÍ≥† ÏûàÎçò ÎÇ¥Ïö©Ïù¥ÏòÄÎçò Í≤É Í∞ôÏùÄÎç∞ ÎòêÎã§Ïãú ÏÉàÎ°úÏö¥ ÎÇ¥Ïö©Ïù¥ ÎêòÏñ¥Î≤ÑÎ¶∞ Í≤É Í∞ôÏïòÎã§. ÌäπÌûà DockerfileÏùò ENV, ARG Î™ÖÎ†πÏñ¥Ïóê ÎåÄÌï¥ÏÑúÎäî Ïù¥ÎØ∏ÏßÄÎ•º ÎπåÎìúÌï† Îïå, Ïª®ÌÖåÏù¥ÎÑàÎ•º Ïã§ÌñâÌï† ÎïåÎ°ú Íµ¨Î∂ÑÎêòÎäîÎç∞, Íµ¨Ï≤¥Ï†ÅÏúºÎ°ú ÎèÑÏª§ÌååÏùºÏùÑ ÏßÅÏ†ë ÏÉùÏÑ±Ìï¥Î≥¥Î©¥ÏÑú Í∞úÎÖêÏùÑ Îã§Ïßà ÌïÑÏöîÍ∞Ä ÏûàÎã§Í≥† ÎäêÍºàÎã§.* 

*ÏïÑÎ¨¥Ìäº Ïù¥Î≤àÏ£ºÏ∞®Î•º Í∏∞Ï†êÏúºÎ°ú ÎèÑÏª§ Ìè¨Ïä§ÌåÖ ÏãúÎ¶¨Ï¶àÎèÑ Î∞òÌôòÏ†êÏùÑ ÎèåÏïòÎã§. Ïó¨Ï†ÑÌûà ÎßéÏù¥ Î∂ÄÏ°±Ìïú Í∏ÄÏù¥ÏßÄÎßå Î∂ÑÎ™Ö Í∏ÄÎ°ú ÎÇ®Í∏∞Í≥† Ï†ïÎ¶¨ÌïòÎäî Í±¥ Ïù¥Ìï¥Ïùò ÎÜçÎèÑÍ∞Ä Îã§Î•º Í±∞ÎùºÍ≥† ÏÉùÍ∞ÅÌïúÎã§. Ïù¥Î≤àÏ£ºÎäî Ïú†ÎÇúÌûà Î≠ò Ìï¥ÎèÑ ÏßëÏ§ëÏù¥ ÏïàÎêòÎäî ÎÇ†Ïù¥ÏóàÎäîÎç∞ ÏùºÎã® Î≤ÑÌÖ®Î≥¥Îäî Í±∏Î°ú ÌïòÏûê!*üëä

<img src="{{ '/assets/p.14/outro.gif' | relative_url }}" alt="Descriptive Alt Text" />

---
### Reference

[Kaggle_R_Dockerfile](References
https://github.com/Kaggle/docker-rstats/blob/main/Dockerfile)

[Please allow me to introduce myself: Torch for R](https://blogs.rstudio.com/ai/posts/2020-09-29-introducing-torch-for-r/)